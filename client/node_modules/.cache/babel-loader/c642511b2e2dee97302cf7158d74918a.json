{"ast":null,"code":"import _classCallCheck from\"/Users/lailysarvarian/a-kanban/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/lailysarvarian/a-kanban/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/lailysarvarian/a-kanban/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/lailysarvarian/a-kanban/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import Card from\"./Card\";import update from\"immutability-helper\";import opensocket from\"socket.io-client\";import{DropTarget}from\"react-dnd\";var Container=/*#__PURE__*/function(_Component){_inherits(Container,_Component);var _super=_createSuper(Container);function Container(props){var _this;_classCallCheck(this,Container);_this=_super.call(this,props);_this.componentDidMount=function(){_this.fetchTasks(\"na\",\"na\");var socket=opensocket(\"http://localhost:8080\");socket.on(\"task\",function(data){if(data.action===\"create\"){_this.fetchTasks(\"na\",\"na\");}});socket.on(\"taskChange\",function(data){if(data.action===\"create\"){_this.fetchTasks(\"na\",\"na\");}});};_this.fetchTasks=function(priority,i){fetch(\"/team/tasks-\".concat(_this.props.team._id,\"-\").concat(i,\"-\").concat(priority)).then(function(res){return res.json();}).then(function(result){_this.setState({tasks:result.tasks});});};_this.sort=function(e,i){e.preventDefault();if(e.target.value===\"dsc\"){_this.fetchTasks(\"na\",\"na\");_this.setState({sort:\"dsc\"});}else if(e.target.value===\"asc\"){fetch(\"/team/tasks-\".concat(_this.props.team._id,\"-na-na\")).then(function(res){return res.json();}).then(function(result){var tempTeam=result.tasks;tempTeam[i]=tempTeam[i].reverse();_this.setState({tasks:tempTeam});});}else if(e.target.value===\"STANDARD\"){fetch(\"/team/tasks-\".concat(_this.props.team._id,\"-\").concat(i,\"-STANDARD\")).then(function(res){return res.json();}).then(function(result){var tempTeam=_this.state.tasks;tempTeam[i]=result.tasks;_this.setState({tasks:tempTeam});});}else if(e.target.value===\"FIXED\"){fetch(\"/team/tasks-\".concat(_this.props.team._id,\"-\").concat(i,\"-FIXED\")).then(function(res){return res.json();}).then(function(result){var tempTeam=_this.state.tasks;tempTeam[i]=result.tasks;_this.setState({tasks:tempTeam});});}else if(e.target.value===\"EXPEDITE\"){fetch(\"/team/tasks-\".concat(_this.props.team._id,\"-\").concat(i,\"-EXPEDITE\")).then(function(res){return res.json();}).then(function(result){var tempTeam=_this.state.tasks;tempTeam[i]=result.tasks;_this.setState({teamTasks:tempTeam});});}};_this.state={cards:props.list,tasks:{},sort:\"asc\"};return _this;}_createClass(Container,[{key:\"pushCard\",value:function pushCard(card){var _this2=this;if(card.responders.filter(function(responder){return responder._id===_this2.props.user;}).length>0){var tempTasks=this.state.tasks;card.stage=this.props.name;tempTasks[this.props.name].push(card);this.setState({tasks:tempTasks});fetch(\"/team-push/\".concat(this.props.team._id),{method:\"PUT\",headers:{Authorization:\"Bearer \"+this.props.token,\"Content-Type\":\"application/json\"},body:JSON.stringify({// user: this.props.user,\n// oldBoard: taskName.split(\"-\")[0],\n// newBoard: board,\n// i: parseFloat(taskName.split(\"+\")[1]),\n// situation: 1,\nuser:this.props.user,board:this.props.name,card:card,action:\"push\"})}).then(function(result){return result.json();}).then(function(res){if(!res.done){alert(res.message);}});}else{alert(\"YOu dont have the right to move this task\");}// this.setState(update(this.state, {\n// \tcards: {\n// \t\t$push: [ card ]\n// \t}\n// }));\n}},{key:\"removeCard\",value:function removeCard(index){var _this3=this;console.log(this.state.tasks[this.props.name][index],\"this.state.tasks[this.props.name][index]\");if(this.state.tasks[this.props.name][index].responders.filter(function(responder){return responder._id===_this3.props.user;}).length>0){var tempTasks=this.state.tasks;tempTasks[this.props.name].splice(index,1);this.setState({tasks:tempTasks});fetch(\"/team-remove/\".concat(this.props.team._id),{method:\"PUT\",headers:{Authorization:\"Bearer \"+this.props.token,\"Content-Type\":\"application/json\"},body:JSON.stringify({// user: this.props.user,\n// oldBoard: taskName.split(\"-\")[0],\n// newBoard: board,\n// i: parseFloat(taskName.split(\"+\")[1]),\n// situation: 1,\nuser:this.props.user,board:this.props.name,index:index,action:\"push\"})}).then(function(result){return result.json();}).then(function(res){if(!res.done){alert(res.message);}});}else{alert(\"YOu dont have the right to move this task\");}// this.setState(update(this.state, {\n// \tcards: {\n// \t\t$splice: [\n// \t\t\t[index, 1]\n// \t\t]\n// \t}\n// }));\n}},{key:\"moveCard\",value:function moveCard(dragIndex,hoverIndex,draggedItem){var tempTasks=this.state.tasks;tempTasks[this.props.name].splice(dragIndex,1);tempTasks[this.props.name].splice(hoverIndex,0,draggedItem);this.setState({tasks:tempTasks});// const { cards } = this.state;\n// const dragCard = cards[dragIndex];\n// this.setState(update(this.state, {\n// \tcards: {\n// \t\t$splice: [\n// \t\t\t[dragIndex, 1],\n// \t\t\t[hoverIndex, 0, dragCard]\n// \t\t]\n// \t}\n// }));\n}},{key:\"render\",value:function render(){var _this4=this;var _this$state=this.state,cards=_this$state.cards,tasks=_this$state.tasks;var _this$props=this.props,canDrop=_this$props.canDrop,isOver=_this$props.isOver,connectDropTarget=_this$props.connectDropTarget;var boardTasks=tasks[this.props.name]?tasks[this.props.name]:[];var isActive=canDrop&&isOver;var backgroundColor=isActive?\"#f5f4f386\":\"#f5f4f349\";return connectDropTarget(/*#__PURE__*/React.createElement(\"div\",{className:\"each-board\",style:{display:\"flex\"},key:\"board-\".concat(this.props.name)},/*#__PURE__*/React.createElement(\"div\",{className:\"board-header\"},/*#__PURE__*/React.createElement(\"div\",{id:\"board-header-title\"},/*#__PURE__*/React.createElement(\"div\",{id:\"circle\"}),this.props.name),/*#__PURE__*/React.createElement(\"select\",{onChange:function onChange(e){return _this4.sort(e,_this4.props.name);},className:\"select-sort \"},/*#__PURE__*/React.createElement(\"option\",{className:\"react-select-option\",value:\"all\"}),/*#__PURE__*/React.createElement(\"option\",{className:\"react-select-option\",value:\"asc\"},\"LEAST RECENT\"),/*#__PURE__*/React.createElement(\"option\",{className:\"react-select-option\",value:\"dsc\"},\"MOST RECENT\"),/*#__PURE__*/React.createElement(\"option\",{className:\"react-select-option\",value:\"STANDARD\"},\"STANDARD\"),/*#__PURE__*/React.createElement(\"option\",{className:\"react-select-option\",value:\"FIXED\"},\"FIXED DATE\"),/*#__PURE__*/React.createElement(\"option\",{className:\"react-select-option\",value:\"EXPEDITE\"},\"EXPEDITE\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"tasks-container\",key:\"tasks-container\",style:{backgroundColor:backgroundColor}},boardTasks.map(function(task,i){return/*#__PURE__*/React.createElement(Card,{key:\"Task-\".concat(i),index:i,listId:_this4.props.id,card:task,removeCard:_this4.removeCard.bind(_this4),moveCard:_this4.moveCard.bind(_this4),token:_this4.props.token,user:_this4.props.user,team:_this4.props.team,opacity:_this4.props.opacity,history:_this4.props.history,taskId:\"\".concat(task.stage,\"-\").concat(task._id,\"+\").concat(i),id:task._id,task:task,position:i,location1:\"top\",location2:\"left\",location2Digit:\".5vw\",unit:\"vh\",page:\"teamPage\"});}))));}}]);return Container;}(Component);var cardTarget={drop:function drop(props,monitor,component){var id=props.id;var sourceObj=monitor.getItem();if(id!==sourceObj.listId)component.pushCard(sourceObj.card);return{listId:id};}};export default DropTarget(\"CARD\",cardTarget,function(connect,monitor){return{connectDropTarget:connect.dropTarget(),isOver:monitor.isOver(),canDrop:monitor.canDrop()};})(Container);","map":{"version":3,"sources":["/Users/lailysarvarian/a-kanban/client/src/components/Container.js"],"names":["React","Component","Card","update","opensocket","DropTarget","Container","props","componentDidMount","fetchTasks","socket","on","data","action","priority","i","fetch","team","_id","then","res","json","result","setState","tasks","sort","e","preventDefault","target","value","tempTeam","reverse","state","teamTasks","cards","list","card","responders","filter","responder","user","length","tempTasks","stage","name","push","method","headers","Authorization","token","body","JSON","stringify","board","done","alert","message","index","console","log","splice","dragIndex","hoverIndex","draggedItem","canDrop","isOver","connectDropTarget","boardTasks","isActive","backgroundColor","display","map","task","id","removeCard","bind","moveCard","opacity","history","cardTarget","drop","monitor","component","sourceObj","getItem","listId","pushCard","connect","dropTarget"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Card from \"./Card\";\nimport update from \"immutability-helper\";\nimport opensocket from \"socket.io-client\";\nimport { DropTarget } from \"react-dnd\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      cards: props.list,\n      tasks: {},\n      sort: \"asc\",\n    };\n  }\n  componentDidMount = () => {\n    this.fetchTasks(\"na\", \"na\");\n    const socket = opensocket(\"http://localhost:8080\");\n    socket.on(\"task\", (data) => {\n      if (data.action === \"create\") {\n        this.fetchTasks(\"na\", \"na\");\n      }\n    });\n    socket.on(\"taskChange\", (data) => {\n      if (data.action === \"create\") {\n        this.fetchTasks(\"na\", \"na\");\n      }\n    });\n  };\n  fetchTasks = (priority, i) => {\n    fetch(\n      `/team/tasks-${this.props.team._id}-${i}-${priority}`\n    )\n      .then((res) => {\n        return res.json();\n      })\n      .then((result) => {\n        this.setState({ tasks: result.tasks });\n      });\n  };\n  sort = (e, i) => {\n    e.preventDefault();\n    if (e.target.value === \"dsc\") {\n      this.fetchTasks(\"na\", \"na\");\n      this.setState({ sort: \"dsc\" });\n    } else if (e.target.value === \"asc\") {\n      fetch(`/team/tasks-${this.props.team._id}-na-na`)\n        .then((res) => {\n          return res.json();\n        })\n        .then((result) => {\n          let tempTeam = result.tasks;\n          tempTeam[i] = tempTeam[i].reverse();\n          this.setState({ tasks: tempTeam });\n        });\n    } else if (e.target.value === \"STANDARD\") {\n      fetch(\n        `/team/tasks-${this.props.team._id}-${i}-STANDARD`\n      )\n        .then((res) => {\n          return res.json();\n        })\n        .then((result) => {\n          let tempTeam = this.state.tasks;\n          tempTeam[i] = result.tasks;\n          this.setState({ tasks: tempTeam });\n        });\n    } else if (e.target.value === \"FIXED\") {\n      fetch(\n        `/team/tasks-${this.props.team._id}-${i}-FIXED`\n      )\n        .then((res) => {\n          return res.json();\n        })\n        .then((result) => {\n          let tempTeam = this.state.tasks;\n          tempTeam[i] = result.tasks;\n          this.setState({ tasks: tempTeam });\n        });\n    } else if (e.target.value === \"EXPEDITE\") {\n      fetch(\n        `/team/tasks-${this.props.team._id}-${i}-EXPEDITE`\n      )\n        .then((res) => {\n          return res.json();\n        })\n        .then((result) => {\n          let tempTeam = this.state.tasks;\n          tempTeam[i] = result.tasks;\n          this.setState({ teamTasks: tempTeam });\n        });\n    }\n  };\n  pushCard(card) {\n    if (\n      card.responders.filter((responder) => responder._id === this.props.user)\n        .length > 0\n    ) {\n      let tempTasks = this.state.tasks;\n      card.stage = this.props.name;\n      tempTasks[this.props.name].push(card);\n\n      this.setState({ tasks: tempTasks });\n      fetch(`/team-push/${this.props.team._id}`, {\n        method: \"PUT\",\n        headers: {\n          Authorization: \"Bearer \" + this.props.token,\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          // user: this.props.user,\n          // oldBoard: taskName.split(\"-\")[0],\n          // newBoard: board,\n          // i: parseFloat(taskName.split(\"+\")[1]),\n          // situation: 1,\n          user: this.props.user,\n          board: this.props.name,\n          card: card,\n          action: \"push\",\n        }),\n      })\n        .then((result) => {\n          return result.json();\n        })\n        .then((res) => {\n          if (!res.done) {\n            alert(res.message);\n          }\n        });\n    } else {\n      alert(\"YOu dont have the right to move this task\");\n    }\n    // this.setState(update(this.state, {\n    // \tcards: {\n    // \t\t$push: [ card ]\n    // \t}\n    // }));\n  }\n\n  removeCard(index) {\n    console.log(\n      this.state.tasks[this.props.name][index],\n      \"this.state.tasks[this.props.name][index]\"\n    );\n    if (\n      this.state.tasks[this.props.name][index].responders.filter(\n        (responder) => responder._id === this.props.user\n      ).length > 0\n    ) {\n      let tempTasks = this.state.tasks;\n      tempTasks[this.props.name].splice(index, 1);\n      this.setState({ tasks: tempTasks });\n      fetch(`/team-remove/${this.props.team._id}`, {\n        method: \"PUT\",\n        headers: {\n          Authorization: \"Bearer \" + this.props.token,\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          // user: this.props.user,\n          // oldBoard: taskName.split(\"-\")[0],\n          // newBoard: board,\n          // i: parseFloat(taskName.split(\"+\")[1]),\n          // situation: 1,\n          user: this.props.user,\n          board: this.props.name,\n          index: index,\n          action: \"push\",\n        }),\n      })\n        .then((result) => {\n          return result.json();\n        })\n        .then((res) => {\n          if (!res.done) {\n            alert(res.message);\n          }\n        });\n    } else {\n      alert(\"YOu dont have the right to move this task\");\n    }\n    // this.setState(update(this.state, {\n    // \tcards: {\n    // \t\t$splice: [\n    // \t\t\t[index, 1]\n    // \t\t]\n    // \t}\n    // }));\n  }\n  moveCard(dragIndex, hoverIndex, draggedItem) {\n    let tempTasks = this.state.tasks;\n    tempTasks[this.props.name].splice(dragIndex, 1);\n    tempTasks[this.props.name].splice(hoverIndex, 0, draggedItem);\n    this.setState({ tasks: tempTasks });\n    // const { cards } = this.state;\n    // const dragCard = cards[dragIndex];\n\n    // this.setState(update(this.state, {\n    // \tcards: {\n    // \t\t$splice: [\n    // \t\t\t[dragIndex, 1],\n    // \t\t\t[hoverIndex, 0, dragCard]\n    // \t\t]\n    // \t}\n    // }));\n  }\n  render() {\n    const { cards, tasks } = this.state;\n    const { canDrop, isOver, connectDropTarget } = this.props;\n    const boardTasks = tasks[this.props.name] ? tasks[this.props.name] : [];\n    const isActive = canDrop && isOver;\n    const backgroundColor = isActive ? \"#f5f4f386\" : \"#f5f4f349\";\n    return connectDropTarget(\n      <div\n        className=\"each-board\"\n        style={{ display: \"flex\" }}\n        key={`board-${this.props.name}`}\n      >\n        <div className=\"board-header\">\n          <div id=\"board-header-title\">\n            <div id=\"circle\"></div>\n            {this.props.name}\n          </div>\n          <select\n            onChange={(e) => this.sort(e, this.props.name)}\n            className=\"select-sort \"\n          >\n            <option className=\"react-select-option\" value=\"all\"></option>\n            <option className=\"react-select-option\" value=\"asc\">\n              LEAST RECENT\n            </option>\n            <option className=\"react-select-option\" value=\"dsc\">\n              MOST RECENT\n            </option>\n            <option className=\"react-select-option\" value=\"STANDARD\">\n              STANDARD\n            </option>\n            <option className=\"react-select-option\" value=\"FIXED\">\n              FIXED DATE\n            </option>\n            <option className=\"react-select-option\" value=\"EXPEDITE\">\n              EXPEDITE\n            </option>\n          </select>\n        </div>\n        <div\n          className=\"tasks-container\"\n          key={\"tasks-container\"}\n          style={{ backgroundColor }}\n        >\n          {boardTasks.map((task, i) => {\n            return (\n              <Card\n                key={`Task-${i}`}\n                index={i}\n                listId={this.props.id}\n                card={task}\n                removeCard={this.removeCard.bind(this)}\n                moveCard={this.moveCard.bind(this)}\n                token={this.props.token}\n                user={this.props.user}\n                team={this.props.team}\n                opacity={this.props.opacity}\n                history={this.props.history}\n                taskId={`${task.stage}-${task._id}+${i}`}\n                id={task._id}\n                task={task}\n                position={i}\n                location1=\"top\"\n                location2=\"left\"\n                location2Digit=\".5vw\"\n                unit=\"vh\"\n                page=\"teamPage\"\n              />\n            );\n          })}\n        </div>\n      </div>\n    );\n  }\n}\nconst cardTarget = {\n  drop(props, monitor, component) {\n    const { id } = props;\n    const sourceObj = monitor.getItem();\n    if (id !== sourceObj.listId) component.pushCard(sourceObj.card);\n    return {\n      listId: id,\n    };\n  },\n};\nexport default DropTarget(\"CARD\", cardTarget, (connect, monitor) => ({\n  connectDropTarget: connect.dropTarget(),\n  isOver: monitor.isOver(),\n  canDrop: monitor.canDrop(),\n}))(Container);\n"]},"metadata":{},"sourceType":"module"}